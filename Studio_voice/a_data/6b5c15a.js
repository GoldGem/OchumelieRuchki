(function DesktopController(){var h=this,e=h.wixInstagramApp,a=e.mediator,j=e.ajaxHelper,i=e.wixMediator,l=window.innerHeight;function k(){$(window).resize(_.debounce(function(){a.publish("application:resized")},2000));a.subscribe("application:init",function(){if(e.account.isPrivate&&!e.user.username&&!e.isInWixEditor()){a.publish("application:private:render");return}j.fetchMedias()});a.subscribe("application:resized",function(){var n=document.getElementsByTagName("body")[0];if(n.offsetWidth<=0&&n.offsetHeight<=0){return}l=window.innerHeight;var o=e.shouldFetch();if(o){j.fetchMedias()}else{}});a.subscribe("application:rendered:preview",function(){var o=$("#comments_wrapper"),n=o.data("jsp");if(n){n.destroy()}});a.subscribe("application:rendered:comments",function(){var o=$("#comments_wrapper"),n=o.data("jsp");o.jScrollPane({mouseWheelSpeed:40,autoReinitialise:true});_.delay(function(){var p=$(window).height();if(p<40){e.setWixHeight(l)}},500)});a.subscribe("application:rendered:pager",function(){_.delay(function(){var n=$(window).height();if(n<40){e.setWixHeight(l)}},500)});a.subscribe("application:resized:textarea",function(){e.setWixHeight(l)});i.wixSubscribe("application:loadState:request",e.publishState);a.subscribe("application:session:loaded",function(){a.publish("application:init");Wix.Performance.applicationLoadingStep(1)});Wix.addEventListener(Wix.Events.SETTINGS_UPDATED,function(){window.location.reload()})}function m(){switch(e.settings.layout){case"left":d();break;case"bottom":g();break;case"preview":c();break;case"thumb":f();break;default:throw new Error("Unknown layout:",e.settings.layout)}}function d(){e.headerView.initialize();e.privateView.initialize();e.errorView.initialize();e.galleryView.initialize();e.previewView.initialize();e.commentsView.initialize();e.pagerView.initialize();e.slideshowView.initialize()}function g(){e.headerView.initialize();e.privateView.initialize();e.errorView.initialize();e.galleryView.initialize();e.previewView.initialize();e.commentsView.initialize();e.pagerView.initialize();e.slideshowView.initialize()}function c(){e.headerView.initialize();e.privateView.initialize();e.errorView.initialize();e.previewView.initialize();e.commentsView.initialize();e.pagerView.initialize();e.slideshowView.initialize()}function f(){e.headerView.initialize();e.privateView.initialize();e.errorView.initialize();e.galleryView.initialize();e.popupView.initialize();e.pagerView.initialize()}function b(){k();e.pager.thumbsPerPage=e.computeMaxNumThumbs();m();e.mainController.start()}e.desktopController={start:b}}).call(this);